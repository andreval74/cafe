<!DOCTYPE html>
<html lang="pt-BR">
<head>
<<<<<<< HEAD
  <meta charset="UTF-8">
  <title>Calculadora de Endere√ßo Personalizado</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../css/styles.css" />
  <style>
    .toggle-container {
      display: flex;
      align-items: center;
      margin: 12px 0;
    }
    .toggle-container input[type="checkbox"] {
      margin-right: 10px;
      transform: scale(1.3);
    }
    #estimativa {
      margin: 10px 0;
      font-size: 14px;
      color: #444;
      background: #f7f7f7;
      padding: 10px;
      border-radius: 8px;
    }
  </style>
=======
  <meta charset="UTF-8" />
  <title>Calculadora de SALT</title>
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <link rel="stylesheet" href="..\css\styles.css" />
>>>>>>> 7fd0caeac51acf9dc600438938d429f67aa575e5
</head>
<body>
  <div class="container">
    <h1>Gerar Endere√ßo Personalizado</h1>

    <label for="deployer">Endere√ßo do Deployer (Contrato Espelhado / Original)</label>
    <input type="text" id="deployer" placeholder="Ex: 0x2bd4...">

    <label for="bytecode">Bytecode do Contrato</label>
    <textarea id="bytecode" rows="6" placeholder="‚ö†Ô∏è Cole aqui o bytecode do contrato"></textarea>

    <label for="target">Personaliza√ß√£o do Endere√ßo: √∫ltimos 4 d√≠gitos desejados (hex)</label>
    <input type="text" id="target" maxlength="4" placeholder="Ex: AbCd">

    <!-- Estimativa din√¢mica -->
    <div id="estimativa"></div>

    <!-- Bot√£o deslizante de case sensitive -->
    <div class="toggle-container">
      <input type="checkbox" id="caseSensitive" checked>
      <label for="caseSensitive">Diferenciar mai√∫sculas de min√∫sculas (case sensitive)</label>
    </div>

    <button onclick="gerar()">Encontrar Salt</button>

    <pre id="output">// O salt e o endere√ßo ser√£o exibidos aqui...</pre>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <script>
    const params = new URLSearchParams(window.location.search);
    const deployerInput = document.getElementById("deployer");
    const targetInput = document.getElementById("target");
    const estimativaDiv = document.getElementById("estimativa");
    const caseCheckbox = document.getElementById("caseSensitive");

    if (params.has("deployer")) {
      deployerInput.value = params.get("deployer");
      deployerInput.readOnly = true;
    }

    // Atualiza estimativa quando o usu√°rio digita
    targetInput.addEventListener("input", function () {
      this.value = this.value.replace(/[^a-fA-F0-9]/g, "");
      atualizarEstimativa(this.value);
    });

    // Atualiza estimativa quando o checkbox muda
    caseCheckbox.addEventListener("change", () => {
      atualizarEstimativa(targetInput.value);
    });

    function atualizarEstimativa(suffix) {
      const n = suffix.length;
      if (n === 0) {
        estimativaDiv.textContent = "";
        return;
      }

      const isCaseSensitive = caseCheckbox.checked;
      const base = isCaseSensitive ? 22 : 16; // 0-9 + a-f (+ A-F se sensitive)
      const possibilidades = Math.pow(base, n);
      const velocidadeEstimada = 10000; // tentativas por segundo
      const tempoSegundos = (possibilidades / velocidadeEstimada).toFixed(1);

      estimativaDiv.innerHTML = `
        üîç <strong>Estimativa (${isCaseSensitive ? 'com' : 'sem'} case sensitive):</strong><br>
        ‚Ä¢ Tentativas m√©dias esperadas: ${possibilidades.toLocaleString()}<br>
        ‚Ä¢ Tempo estimado: ~${tempoSegundos} segundos
      `;
    }

    async function gerar() {
      const deployer = deployerInput.value.trim();
      const bytecode = document.getElementById("bytecode").value.trim();
      const targetSuffix = document.getElementById("target").value.trim();
      const caseSensitive = document.getElementById("caseSensitive").checked;
      const output = document.getElementById("output");

      if (!/^0x[a-fA-F0-9]{40}$/.test(deployer)) {
        output.textContent = "‚ùå Endere√ßo do deployer inv√°lido.";
        return;
      }

      if (!/^0x[a-fA-F0-9]+$/.test(bytecode)) {
        output.textContent = "‚ùå Bytecode inv√°lido. Certifique-se de copiar corretamente do Remix.";
        return;
      }

      if (!/^[a-fA-F0-9]{4}$/.test(targetSuffix)) {
        output.textContent = "‚ùå Os √∫ltimos 4 d√≠gitos devem estar em formato hexadecimal.";
        return;
      }

      const { keccak256, hexZeroPad, hexlify } = ethers.utils;
      const bytecodeHash = keccak256(bytecode);
      let found = false;

      const startTime = performance.now();

      for (let i = 0; i < 100000000; i++) {
        const salt = hexZeroPad(hexlify(i), 32);
        const data = `0xff${deployer.slice(2)}${salt.slice(2)}${bytecodeHash.slice(2)}`;
        const address = "0x" + keccak256(data).slice(-40);
        const addressSuffix = address.slice(-4);

        const match = caseSensitive
          ? addressSuffix === targetSuffix
          : addressSuffix.toLowerCase() === targetSuffix.toLowerCase();

        if (match) {
          const endTime = performance.now();
          const durationSeconds = ((endTime - startTime) / 1000).toFixed(2);

          output.textContent = `
‚úîÔ∏è Endere√ßo com final '${targetSuffix}' encontrado:
Salt decimal: ${BigInt(salt).toString()}
Salt hexadecimal: ${salt}
Endere√ßo gerado: 0x${address}
Tempo total: ${durationSeconds} segundos
Tentativas: ${i.toLocaleString()}`;
          found = true;
          break;
        }

        if (i % 1000 === 0) {
          output.textContent = `‚è≥ Verificando combina√ß√µes... ${i.toLocaleString()} tentativas at√© agora.`;
          await new Promise(r => setTimeout(r, 1));
        }
      }

      if (!found) {
        const endTime = performance.now();
        const durationSeconds = ((endTime - startTime) / 1000).toFixed(2);
        output.textContent = `‚ùå Nenhum endere√ßo encontrado com esse sufixo nas primeiras 100.000.000 tentativas.
Tempo total: ${durationSeconds} segundos.`;
      }
    }
  </script>
</body>
</html>
